{% extends "base.html" %}

{% block title %}Analyze Resume - Smart ATS{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10">
        <div class="card shadow-lg border-0">
            <div class="card-header bg-white py-3">
                <h4 class="mb-0 fw-bold text-primary"><i class="fas fa-microscope me-2"></i>ATS Analysis Engine</h4>
            </div>
            <div class="card-body p-4">
                <form id="analysisForm" action="{{ url_for('process_analysis') }}" method="POST" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-6 border-end">
                            <h5 class="fw-bold mb-3">1. Your Resume</h5>
                            <div class="mb-4">
                                <label class="form-label text-muted">Upload PDF version of your resume</label>
                                <div class="upload-box border-dashed p-5 text-center bg-light rounded" id="drop-area">
                                    <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                    <input type="file" name="resume_file" id="resume_file" class="form-control" accept=".pdf" required>
                                    <p class="small text-muted mt-2">Only PDF files are supported for ATS scanning.</p>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <h5 class="fw-bold mb-3">2. Job Description (Optional)</h5>
                            <div class="mb-3">
                                <label class="form-label text-muted">Paste the JD here for comparison scoring</label>
                                <textarea name="job_description" class="form-control" rows="8" placeholder="Paste the job responsibilities and requirements here to see how well you match..."></textarea>
                            </div>
                        </div>
                    </div>

                    <hr class="my-4">

                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg px-5 fw-bold" id="analyzeBtn">
                            <i class="fas fa-sync-alt me-2"></i> Run ATS Scan
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="loadingOverlay" class="d-none position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center" style="background: rgba(255,255,255,0.8); z-index: 9999;">
            <div class="text-center">
                <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
                <h5 class="mt-3 fw-bold">ML Model Analyzing Patterns...</h5>
                <p class="text-muted">Comparing vector embeddings and keyword density</p>
            </div>
        </div>
    </div>
</div>

<style>
    .border-dashed {
        border: 2px dashed #dee2e6;
        transition: all 0.3s ease;
    }
    .upload-box:hover {
        border-color: #3498db;
        background-color: #ebf5fb !important;
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('analysisForm').onsubmit = function() {
        // Show loading overlay
        document.getElementById('loadingOverlay').classList.remove('d-none');
        document.getElementById('analyzeBtn').disabled = true;
    };
</script>
{% endblock %}